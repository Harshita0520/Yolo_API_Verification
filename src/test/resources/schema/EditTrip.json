{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "id": {
      "type": "integer",
      "minimum": 1
    },
    "subtrips": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "id": { "type": "integer", "minimum": 1 },
          "to_stop_name": { "type": "string", "minLength": 1 },
          "from_stop_name": { "type": "string", "minLength": 1 },

          "to_stop": {
            "type": "object",
            "properties": {
              "name": { "type": "string", "minLength": 1 },
              "latitude": { "type": "number" },
              "longitude": { "type": "number" }
            },
            "required": ["name", "latitude", "longitude"]
          },

          "from_stop": {
            "type": "object",
            "properties": {
              "name": { "type": "string", "minLength": 1 },
              "latitude": { "type": "number" },
              "longitude": { "type": "number" }
            },
            "required": ["name", "latitude", "longitude"]
          },

          "created_at": { "type": "string", "format": "date-time" },
          "updated_at": { "type": "string", "format": "date-time" },
          "deleted_at": { "type": ["string", "null"] },

          "from_stop_id": { "type": "integer", "minimum": 1 },
          "to_stop_id": { "type": "integer", "minimum": 1 },
          "duration": { "type": "integer", "minimum": 0 },
          "status": { "type": "integer" },
          "bitla_ref_id": { "type": "integer", "minimum": 0 },

          "blocked_subtrips": {
            "type": "array",
            "items": {
              "type": "integer",
              "minimum": 1
            }
          },

          "trip": { "type": "integer", "minimum": 1 }
        },
        "required": [
          "id",
          "to_stop_name",
          "from_stop_name",
          "to_stop",
          "from_stop",
          "created_at",
          "updated_at",
          "from_stop_id",
          "to_stop_id",
          "duration",
          "status",
          "bitla_ref_id",
          "blocked_subtrips",
          "trip"
        ]
      }
    },

    "vehicle_number": {
      "type": "string",
      "pattern": "^[A-Z]{2}\\d{1,2}[A-Z]{0,2}\\d{1,4}$"
    },
    "vehicle_type": { "type": "string", "minLength": 1 },

    "crew_info": {
      "type": "object",
      "properties": {
        "bus_operator": {
          "type": "object",
          "properties": {
            "id": { "type": "integer", "minimum": 1 },
            "name": { "type": "string", "minLength": 1 }
          },
          "required": ["id", "name"]
        },
        "bus_captain": {
          "type": "object",
          "properties": {
            "id": { "type": "integer", "minimum": 1 },
            "name": { "type": "string", "minLength": 1 }
          },
          "required": ["id", "name"]
        },
        "driver": {
          "type": "object",
          "properties": {
            "id": { "type": "integer", "minimum": 1 },
            "name": { "type": "string", "minLength": 1 }
          },
          "required": ["id", "name"]
        },
        "helper": {
          "type": "object",
          "properties": {
            "id": { "type": "integer", "minimum": 1 },
            "name": { "type": "string", "minLength": 1 }
          },
          "required": ["id", "name"]
        }
      },
      "required": ["bus_operator", "bus_captain", "driver", "helper"]
    },

    "route_details": {
      "type": "object",
      "properties": {
        "name": { "type": "string", "minLength": 1 },
        "template_name": { "type": "string", "minLength": 1 },
        "duration": { "type": "string", "pattern": "^\\d+$" },

        "from_city": {
          "type": "object",
          "properties": {
            "name": { "type": "string", "minLength": 1 },
            "latitude": { "type": "number" },
            "longitude": { "type": "number" }
          },
          "required": ["name", "latitude", "longitude"]
        },

        "to_city": {
          "type": "object",
          "properties": {
            "name": { "type": "string", "minLength": 1 },
            "latitude": { "type": "number" },
            "longitude": { "type": "number" }
          },
          "required": ["name", "latitude", "longitude"]
        },

        "from_city_name": { "type": "string", "minLength": 1 },
        "to_city_name": { "type": "string", "minLength": 1 },
        "start_time": { "type": "string", "pattern": "^([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d$" },
        "end_time": { "type": "string", "pattern": "^([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d$" },

        "parent_sub_trip": {
          "type": "object",
          "properties": {
            "id": { "type": "integer", "minimum": 1 }
          },
          "required": ["id"]
        },

        "from_city_id": { "type": "integer", "minimum": 1 },
        "to_city_id": { "type": "integer", "minimum": 1 }
      },
      "required": [
        "name",
        "template_name",
        "duration",
        "from_city",
        "to_city",
        "from_city_name",
        "to_city_name",
        "start_time",
        "end_time",
        "parent_sub_trip",
        "from_city_id",
        "to_city_id"
      ]
    },

    "created_at": { "type": "string", "format": "date-time" },
    "updated_at": { "type": "string", "format": "date-time" },
    "deleted_at": { "type": ["string", "null"] },

    "service_template_id": { "type": "integer", "minimum": 1 },
    "service_schedule_id": { "type": "integer", "minimum": 1 },
    "journey_date": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
    },

    "vehicle_id": { "type": "integer", "minimum": 1 },
    "driver_id": { "type": "integer", "minimum": 1 },
    "captain_id": { "type": "integer", "minimum": 1 },
    "helper_id": { "type": "integer", "minimum": 1 },

    "status": { "type": "integer" },
    "bitla_ref_id": { "type": "integer", "minimum": 0 },
    "added_by": { "type": "integer", "minimum": 1 },
    "updated_by": { "type": "integer", "minimum": 1 },
    "is_swaped": { "type": "integer", "enum": [0, 1] },
    "is_agent_flat": { "type": "integer", "enum": [0, 1] }
  },
  "required": [
    "id",
    "subtrips",
    "vehicle_number",
    "vehicle_type",
    "crew_info",
    "route_details",
    "created_at",
    "updated_at",
    "service_template_id",
    "service_schedule_id",
    "journey_date",
    "vehicle_id",
    "driver_id",
    "captain_id",
    "helper_id",
    "status",
    "bitla_ref_id",
    "added_by",
    "updated_by",
    "is_swaped",
    "is_agent_flat"
  ]
}
